import asyncio
import aiohttp
from pathlib import Path
from bs4 import BeautifulSoup

# Исходный словарь с обозначениями Tikkurila и произвольными названиями
tikkurila_colors = {
    "F302": "Мягкое мороженое",
    "G302": "Маслянисто-лимонный",
    "H302": "Лимонный мусс",
    "J302": "Солнечно-желтый",
    "K302": "Лютиковый желтый",
    "L302": "Фрезия",
    "M302": "Шафрановый желтый",
    "N302": "Насыщенный желтый",
    "S302": "Цейлонский желтый",
    "V302": "Цвет пампасной травы",
    "X302": "Желтая роза",
    "Y302": "Слоновая кость",
    "F303": "Молочно-ванильный",
    "G303": "Ваниль",
    "H303": "Абрикосовое мороженое",
    "J303": "Льняной",
    "K303": "Светлый янтарно-желтый",
    "L303": "Карри",
    "M303": "Янтарный",
    "N303": "Медово-желтый",
    "S303": "Насыщенный золотой",
    "V303": "Цвет желтой глины",
    "X303": "Палевый (Кожи буйвола)",
    "Y303": "Заварной крем",
    "F307": "Молочно-белый",
    "G307": "Мягкий оттенок белого камня",
    "H307": "Солнце Сахары",
    "J307": "Светлая осень",
    "K307": "Пастельно-желтый",
    "L307": "Умеренный оранжево-желтый",
    "M307": "Тыквенный",
    "N307": "Восковый",
    "S307": "Умеренный желтый",
    "V307": "Золотой туман",
    "X307": "Овсяный",
    "Y307": "Белый антик",
    "F309": "Цветочный белый",
    "G309": "Винтажное кружево",
    "H309": "Перламутр",
    "J309": "Оранжево-розовый светлый",
    "K309": "Светлая календула",
    "L309": "Календула",
    "M309": "Абрикос",
    "N309": "Оранжевый",
    "S309": "Мандарин",
    "V309": "Апельсиновый",
    "X309": "Замшевый",
    "Y309": "Желто-персиковый",
    "F323": "Бело-розовый фарфор",
    "G323": "Цветок миндаля",
    "H323": "Клубничный мусс",
    "J323": "Тосканский розовый",
    "K323": "Пионово-розовый",
    "L323": "Амарантовый красный",
    "M323": "Помадный красный",
    "N323": "Академический красный",
    "S323": "Малиново-розовый",
    "V323": "Цвет старой розы",
    "X323": "Пастельный розовый",
    "Y323": "Цвет сладкой ваты",
    "F327": "Розовый лотос",
    "G327": "Клубничный шербет",
    "H327": "Цвет душистого горошка",
    "J327": "Антуриум",
    "K327": "Яркий амарантовый",
    "L327": "Малиновый",
    "M327": "Клюквенный",
    "N327": "Гранатовый красный",
    "S327": "Душистая клубника",
    "V327": "Цвет лепестков розы",
    "X327": "Средне-розовый",
    "Y327": "Легкий розовый",
    "F332": "Нежно-розовый",
    "G332": "Средне-розовый",
    "H332": "Английская роза",
    "J332": "Натуральный розовый",
    "K332": "Турецкий лукум",
    "L332": "Ягодный",
    "M332": "Винно-красный",
    "N332": "Глубокий рубиновый",
    "S332": "Брусничный",
    "V332": "Роза Барокко",
    "X332": "Рассветный розовый",
    "Y332": "Дымчато-розовый",
    "F336": "Кремово-розовый",
    "G336": "Маршмеллоу",
    "H336": "Цвет розовой гвоздики",
    "J336": "Фламинго",
    "K336": "Гламурный розовый",
    "L336": "Сочный малиновый",
    "M336": "Клюквенный",
    "N336": "Свекольный",
    "S336": "Цвет сангрии",
    "V336": "Лилово-розовый",
    "X336": "Розовато-лиловый светлый",
    "Y336": "Розовый кварц",
    "F358": "Арктический лед",
    "G358": "Голубой лед",
    "H358": "Голубой мираж",
    "J358": "Васильковый светлый",
    "K358": "Пронзительный голубой",
    "L358": "Кобальт",
    "M358": "Глубоководный синий",
    "N358": "Ультрамарин",
    "S358": "Небесно-голубой",
    "V358": "Младенческий голубой",
    "X358": "Сумеречно-голубой",
    "F363": "Морозный иней",
    "G363": "Пасмурно-небесный",
    "H363": "Светло-голубой",
    "J363": "Цвет голубой глины",
    "K363": "Адриатический синий",
    "L363": "Темно-лазурный",
    "M363": "Берлинская лазурь",
    "N363": "Океанический синий",
    "S363": "Ниагарский водопад",
    "V363": "Синий дым",
    "X363": "Голубой топаз",
    "F366": "Морозная лазурь",
    "G366": "Аква",
    "H366": "Аквамарин",
    "J366": "Свежий бриз",
    "K366": "Лазурный",
    "L366": "Голубая лагуна",
    "M366": "Черное море",
    "N366": "Глубокий атлантический",
    "S366": "Морская волна",
    "V366": "Синий шторм",
    "X366": "Снежно-синий",
    "G368": "Очень светлый бирюзовый",
    "H368": "Светлый бирюзовый",
    "J368": "Голубино-сизый",
    "K368": "Водная синь",
    "L368": "Мурена",
    "M368": "Глубокий темно-бирюзовый",
    "N368": "Серо-бирюзовый",
    "S368": "Аспидно-синий",
    "V368": "Цвет утиного яйца",
    "H382": "Венская зелень",
    "J382": "Крыжовник",
    "K382": "Зеленое яблоко",
    "L382": "Шартрез",
    "M382": "Лиственно-зеленый",
    "N382": "Кленовый зеленый",
    "S382": "Нефритовый зеленый",
    "V382": "Светлый нефрит",
    "X382": "Чайное дерево",
    "H384": "Мягкий оттенок мяты",
    "J384": "Цвет перечной мяты",
    "K384": "Эвкалиптовый",
    "L384": "Зеленый папоротник",
    "M384": "Спаржевый",
    "N384": "Хвойный зеленый",
    "S384": "Кипарис",
    "V384": "Полынный",
    "X384": "Сероватый мятный",
    "F387": "Разбеленный салатовый",
    "G387": "Бледно-салатовый",
    "H387": "Светлый фисташковый",
    "J387": "Салатовый",
    "K387": "Фисташковый",
    "L387": "Средне-зеленый",
    "M387": "Песто",
    "N387": "Цвет еловой хвои",
    "S387": "Травяной зеленый",
    "V387": "Мякоть лайма",
    "X387": "Цвет зеленого горошка",
    "F388": "Ванильно-лаймовый",
    "G388": "Лимонно-лаймовое безе",
    "H388": "Лаймовый шербет",
    "J388": "Светлый грушевый",
    "K388": "Лемонграсс",
    "L388": "Лайм",
    "M388": "Темный лаймовый",
    "N388": "Авокадо",
    "S388": "Бергамот",
    "V388": "Фисташковый пломбир",
    "X388": "Светлый лайм",
    "F401": "Восход",
    "G401": "Золотисто-персиковый",
    "H401": "Марципан",
    "J401": "Золотисто-коричневый",
    "K401": "Сепия",
    "L401": "Охра",
    "M401": "Тоффи",
    "N401": "Корица",
    "S401": "Фундук",
    "V401": "Пралине",
    "X401": "Розовый древесный",
    "Y401": "Фарфорово-бежевый",
    "F405": "Молочный опал",
    "G405": "Яблоневый цвет",
    "H405": "Пудрово-персиковый",
    "J405": "Сомон",
    "K405": "Яблоко с корицей",
    "L405": "Печеное яблоко",
    "M405": "Терракотово-коричный",
    "N405": "Красное дерево",
    "S405": "Ржаво-оранжевый",
    "V405": "Карамель",
    "X405": "Карамельно-розовый",
    "Y405": "Бледный кизил",
    "F406": "Розовый опал",
    "G406": "Розовый закат",
    "H406": "Каирская роза",
    "J406": "Жареный миндаль",
    "K406": "Закат Сахары",
    "L406": "Цвет сырой охры",
    "M406": "Гончарная глина",
    "N406": "Рыжий",
    "S406": "Глиняный",
    "V406": "Кленовый сироп",
    "X406": "Миндальное печенье",
    "Y406": "Персиковый нюд",
    "F411": "Коралловое облако",
    "G411": "Розовая пудра",
    "H411": "Персиковый сорбет",
    "J411": "Розовый мак",
    "K411": "Герань",
    "L411": "Паприка",
    "M411": "Багряный",
    "N411": "Калина",
    "S411": "Кирпичный",
    "V411": "Тоскана",
    "X411": "Пыльный коралл",
    "Y411": "Розовая камея",
    "F428": "Серебристо-лиловый",
    "G428": "Вечерняя мгла",
    "H428": "Светлый ламантин",
    "J428": "Ламантин",
    "K428": "Перламутровый ежевичный",
    "L428": "Ночная тень",
    "M428": "Глубокий черничный",
    "N428": "Сланцево-серый",
    "S428": "Светлый сланцевый",
    "V428": "Платиновый серый",
    "X428": "Серовато-фарфоровый",
    "Y428": "Платина",
    "F431": "Полярный голубой",
    "H431": "Цвет голубого колокольчика",
    "J431": "Сине-голубой",
    "K431": "Синий деним",
    "L431": "Перламутровый ночной",
    "M431": "Индиго",
    "N431": "Полночная синь",
    "S431": "Грозовое небо",
    "V431": "Деним",
    "F435": "Пепельно-льдистый",
    "G435": "Циркон",
    "K435": "Веджвуд",
    "M435": "Вечерний синий",
    "N435": "Космический синий",
    "S435": "Дымчато-голубой",
    "V435": "Серый агат",
    "X435": "Морская пена",
    "F436": "Капли дождя",
    "N436": "Сизый цвет дикой утки",
    "S436": "Свинцовый",
    "F457": "Ванильно-серый",
    "G457": "Льняной",
    "H457": "Натуральный цвет камня",
    "J457": "Галечный серый",
    "N457": "Табачный",
    "G472": "Пудра",
    "J472": "Орехово-розовый",
    "L472": "Ореховый",
    "M472": "Жареный каштан",
    "S472": "Теплый ореховый",
    "X472": "Миндальная пудра",
    "F476": "Легкий румянцевый",
    "J476": "Розовый цикорий",
    "K476": "Красный цикорий",
    "M476": "Красновато-коричневый",
    "S476": "Шоколадный трюфель",
    "L478": "Махагоновый",
    "M478": "Темный махагон",
    "N478": "Ромовый изюм",
    "F480": "Миндальный крем",
    "G480": "Какао-мусс",
    "H480": "Какао с молоком",
    "J480": "Натуральная пенька",
    "K480": "Шоколадный пломбир",
    "L480": "Молочный шоколад",
    "M480": "Горький шоколад",
    "N480": "Шоколад",
    "S480": "Молочный шоколад",
    "V480": "Кашемировая шерсть",
    "F484": "Белая ночь",
    "G484": "Устрично-бежевый",
    "H484": "Разбеленный кофейный",
    "J484": "Кофе латте",
    "K484": "Кофе фраппе",
    "L484": "Пряный эспрессо",
    "M484": "Каштановый",
    "N484": "Капуччино",
    "S484": "Мокко",
    "V484": "Кофе латте",
    "X484": "Серый сланцевый",
    "Y484": "Кварц",
    "F488": "Сумеречный серый",
    "G488": "Французский серый",
    "H488": "Муссон",
    "J488": "Каменно-серый",
    "K488": "Серый",
    "L488": "Дымчатый серый",
    "M488": "Глубокий серый",
    "N488": "Мокрый асфальт",
    "S488": "Лакрица",
    "Y488": "Черный",
    "F311": "Крем-брюле",
    "G311": "Кремовый абрикосовый",
    "H311": "Абрикосовый шербет",
    "J311": "Теплый абрикосовый",
    "K311": "Медово-абрикосовый",
    "L311": "Охристый",
    "M311": "Желтый кадмий",
    "N311": "Медно-рыжий",
    "S311": "Мягкий медно-оранжевый",
    "V311": "Топаз",
    "X311": "Бежевый",
    "Y311": "Телесный",
    "F314": "Персиковый лед",
    "G314": "Песок пустыни",
    "H314": "Персик в сливках",
    "J314": "Нектарин",
    "K314": "Терракота",
    "L314": "Цвет хурмы",
    "M314": "Морковный",
    "N314": "Пряный оранжевый",
    "S314": "Светло-морковный",
    "V314": "Цвет сырой охры",
    "X314": "Карамельно-персиковый",
    "Y314": "Бледно-персиковый",
    "F319": "Мягкий розовый",
    "G319": "Цвет розовой воды",
    "H319": "Флер-д-оранж",
    "J319": "Коралловая дымка",
    "K319": "Танжерин",
    "L319": "Цвет кайенского перца",
    "M319": "Пламенный красный",
    "N319": "Карминный красный",
    "S319": "Паприка",
    "V319": "Персиковый",
    "X319": "Темный пудровый",
    "Y319": "Жемчужный",
    "F320": "Цвет перламутровой раковины",
    "G320": "Приглушенный персиковый",
    "H320": "Лососево-розовый",
    "J320": "Львиный зев",
    "K320": "Коралловый",
    "L320": "Алый",
    "M320": "Маковый красный",
    "N320": "Театральный красный",
    "S320": "Киноварь",
    "V320": "Розовый антик",
    "X320": "Цвет розового кизила",
    "Y320": "Розовый кристалл",
    "F338": "Райский розовый",
    "G338": "Розовое парфе",
    "H338": "Камелия",
    "J338": "Эпатажный розовый",
    "K338": "Неоновый розовый",
    "L338": "Маджента",
    "M338": "Фуксия",
    "N338": "Цвет красной сливы",
    "S338": "Мальва",
    "V338": "Маджентовая дымка",
    "X338": "Лавандово-розовый",
    "Y338": "Йогуртовый розовый",
    "F342": "Цвет розовой примулы",
    "G342": "Розовый туман",
    "H342": "Лаванда",
    "J342": "Вереск",
    "K342": "Аметист",
    "L342": "Насыщенный пурпурный",
    "M342": "Тёмно-пурпурный",
    "N342": "Черничный",
    "S342": "Фиалка",
    "V342": "Сияющая орхидея",
    "X342": "Глициния",
    "Y342": "Мягкий лавандовый",
    "F351": "Ледник",
    "G351": "Фарфорово-голубой",
    "H351": "Дымчато-голубой",
    "J351": "Нежный сиреневый",
    "K351": "Оттенок гиацинта",
    "L351": "Имперский пурпур",
    "M351": "Глубокий пурпурно-синий",
    "N351": "Средиземное море",
    "S351": "Виола",
    "V351": "Розмариновый",
    "X351": "Перванш",
    "Y351": "Светлый серо-голубой",
    "F355": "Лунный камень",
    "G355": "Весеннее небо",
    "H355": "Цветок незабудки",
    "J355": "Синий прованс",
    "K355": "Колокольчиковый синий",
    "L355": "Королевский синий",
    "M355": "Глубокий чернильный",
    "N355": "Сапфир",
    "S355": "Синий лазурит",
    "V355": "Серо-голубой",
    "X355": "Французский голубой",
    "Y355": "Воздушный голубой",
    "F370": "Разбеленный мятный",
    "G370": "Ледяной ментоловый",
    "H370": "Пастельно-бирюзовый",
    "J370": "Прохладный бирюзовый",
    "K370": "Средне-бирюзовый",
    "L370": "Атлантида",
    "M370": "Насыщенный изумрудный",
    "N370": "Изумрудный",
    "S370": "Зеленая патина",
    "V370": "Припыленный бирюзовый",
    "X370": "Морская пена",
    "Y370": "Холодный светло-бирюзовый",
    "G372": "Снежный мятный",
    "H372": "Мятное мороженое",
    "J372": "Ментоловый",
    "K372": "Тиффани",
    "L372": "Цветущий луг",
    "M372": "Опаловый зеленый",
    "N372": "Зеленая сосна",
    "S372": "Персидский зеленый",
    "V372": "Нежная мята",
    "X372": "Нежный мятно-голубой",
    "F375": "Мятно-кремовый",
    "G375": "Светлый мятный",
    "H375": "Зеленая мята",
    "J375": "Трилистник",
    "K375": "Холодный зеленый",
    "L375": "Малахитовый зеленый",
    "M375": "Бутылочный зеленый",
    "N375": "Темно-зеленый",
    "S375": "Мягкий оттенок папоротника",
    "V375": "Цвет жимолости",
    "X375": "Акриловый зеленый",
    "F380": "Мятный пломбир",
    "G380": "Зеленый чай",
    "H380": "Виноградно-зеленый",
    "J380": "Весенняя зелень",
    "K380": "Травянистый зеленый",
    "L380": "Лесная зелень",
    "M380": "Насыщенный зеленый",
    "N380": "Миртовый",
    "S380": "Темный весенне-зеленый",
    "V380": "Аспарагус",
    "X380": "Светлый аспарагус",
    "Y380": "Бледно-зеленый",
    "F390": "Медовая роса",
    "G390": "Выбеленный лен",
    "H390": "Банановый крем",
    "J390": "Лимонный шербет",
    "K390": "Цитрусовый лимонад",
    "L390": "Дюшес",
    "M390": "Насыщенный грушевый",
    "N390": "Грушевый",
    "S390": "Липовый желто-зеленый",
    "V390": "Бамбуковый желтый",
    "X390": "Бледный лимонный",
    "F392": "Сгущеное молоко",
    "G392": "Пина колада",
    "H392": "Желтая роза",
    "J392": "Песочный",
    "K392": "Пряная горчица",
    "L392": "Дижонская горчица",
    "M392": "Античное золото",
    "N392": "Бронзовый",
    "S392": "Золото",
    "V392": "Льняной",
    "X392": "Соломенно-желтый",
    "Y392": "Светлый соломенный",
    "F393": "Брызги шампанского",
    "G393": "Солнечный лимонный",
    "H393": "Лимонная меренга",
    "J393": "Натуральный пшеничный",
    "K393": "Золотистый",
    "L393": "Темное золото",
    "M393": "Латунный",
    "N393": "Золотой дуб",
    "S393": "Мягкая карамель",
    "V393": "Ореховая нуга",
    "X393": "Бисквитный",
    "Y393": "Белый антик",
    "F398": "Экрю",
    "G398": "Перламутровый бежевый",
    "H398": "Светлый пшеничный",
    "J398": "Палевый",
    "K398": "Шамоа (Цвет верблюжей шерсти)",
    "L398": "Медовый",
    "M398": "Натуральная умбра",
    "N398": "Коричневый охристый",
    "S398": "Желто-коричневый",
    "V398": "Песочно-желтый",
    "X398": "Сладкое печенье",
    "Y398": "Бискотти",
    "F416": "Розовый мрамор",
    "G416": "Розовый вечер",
    "H416": "Пепельная роза",
    "J416": "Медно-розовый",
    "K416": "Розовый бренди",
    "L416": "Гвоздика",
    "M416": "Бурый оттенок хны",
    "N416": "Коньячный",
    "S416": "Имбирный пряник",
    "V416": "Мускатный орех",
    "X416": "Яблочный чатни",
    "Y416": "Чайная роза",
    "F419": "Розовый зефир",
    "G419": "Прохладный розовый",
    "H419": "Мускатный розовый",
    "J419": "Румяный",
    "K419": "Марсала",
    "L419": "Имбирный",
    "M419": "Бургундский",
    "N419": "Спелая вишня",
    "S419": "Приглушенный гранатовый",
    "V419": "Мусс спелой вишни",
    "X419": "Оттенок увядшей розы",
    "Y419": "Цветок миндаля",
    "F424": "Вербена розовая",
    "G424": "Розовый ландыш",
    "H424": "Сладкий лиловый",
    "J424": "Тубероза",
    "K424": "Турмалиновый розовый",
    "L424": "Приглушенный брусничный",
    "M424": "Божоле",
    "N424": "Черная смородина",
    "S424": "Виноградный глинтвейн",
    "V424": "Лиловый",
    "X424": "Лавандовая дымка",
    "Y424": "Цвет дымчатой орхидеи",
    "F426": "Оттенок орхидеи",
    "G426": "Мягкий лунно-лиловый",
    "H426": "Серо-лиловый",
    "J426": "Перепелиный",
    "K426": "Морской туман",
    "L426": "Инжир",
    "M426": "Чернослив",
    "N426": "Ежевичный",
    "S426": "Светлый ежевичный",
    "V426": "Сиреневый пепел",
    "X426": "Лилово-серый",
    "Y426": "Пастельный лиловый",
    "H438": "Серебристый водопад",
    "L438": "Океанический зеленый",
    "N438": "Маренго",
    "K441": "Мятно-бирюзовый",
    "M441": "Холодный изумрудный",
    "G444": "Светлый дымчато-зеленый",
    "H444": "Дымчато-зеленый",
    "J444": "Тростниковый зеленый",
    "K444": "Таинственный лес",
    "L444": "Темный хвойный",
    "M444": "Таёжный омут",
    "N444": "Болотный зеленый",
    "S444": "Сланцевый зеленый",
    "V444": "Фельдграу",
    "J448": "Серо-зеленый",
    "K448": "Листья шалфея",
    "L448": "Мягкий хвойно-зеленый",
    "M448": "Кактус",
    "N448": "Зеленый хаки",
    "S448": "Милитари",
    "V448": "Защитный хаки",
    "X448": "Бледный серо-зеленый",
    "H452": "Темно-зеленый чай",
    "J452": "Мягкий оливковый",
    "L452": "Оливковый",
    "M452": "Темный оливковый",
    "N452": "Лавровый",
    "S452": "Элегантный оливковый",
    "V452": "Светлый оливковый",
    "F456": "Алебастровый",
    "G456": "Жасмин",
    "H456": "Шампанское",
    "J456": "Сандаловое дерево",
    "K456": "Охристо-оливковый",
    "L456": "Камыш",
    "M456": "Дуб",
    "N456": "Античная бронза",
    "S456": "Песчаник",
    "V456": "Золотисто-песочный",
    "X456": "Арахис",
    "H497": "Речной перламутр",
    "J497": "Серый шелк",
    "K497": "Ко`вентри",
    "L497": "Серая гавань",
    "M497": "Цвет акульей кожи",
    "N497": "Цементно-серый",
    "S497": "Серый хаки",
    "V497": "Земляной серый",
    "G499": "Ледниковый серый",
    "H499": "Пыльно-серый",
    "J499": "Агатовый серый",
    "K499": "Титановый",
    "L499": "Стальной",
    "M499": "Графит",
    "N499": "Грифельный серый",
    "S499": "Антрацит",
    "X499": "Черный",
    "F500": "Утренний смог",
    "G500": "Балтийский туман",
    "H500": "Алюминиево-серый",
    "J500": "Пепельный",
    "K500": "Серый нейтральный",
    "L500": "Голубиный серый",
    "M500": "Грифельный",
    "N500": "Оловянный",
    "S500": "Глубокий серый",
    "V500": "Гранит",
    "X500": "Угольный"
}

# Базовый URL для страниц с цветами
base_page_url = "https://tikkurila.com/pro/collection/symphony-color-system?keyword="

# Папка для сохранения изображений
output_dir = Path("color_images")
output_dir.mkdir(exist_ok=True)

# Словарь для хранения путей к сохраненным изображениям
new_color_dict = {}

# Заголовки для имитации браузера
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
}

async def fetch_page(session, code, name):
    page_url = f"{base_page_url}{code}"
    try:
        async with session.get(page_url, headers=headers) as response:
            if response.status != 200:
                print(f"Ошибка загрузки страницы для {name} ({code}): статус {response.status}")
                return name, "Ошибка загрузки"
            
            # Парсим HTML
            text = await response.text()
            soup = BeautifulSoup(text, 'html.parser')
            img_tag = soup.find('img', class_='image-style-scale-crop-large-480-480')
            
            if not img_tag or 'src' not in img_tag.attrs:
                print(f"Изображение не найдено на странице для {name} ({code})")
                return name, "Ошибка загрузки"
            
            # Получаем URL изображения
            image_url = img_tag['src']
            if image_url.startswith('/'):
                image_url = f"https://tikkurila.com{image_url}"
            
            # Загружаем изображение
            file_name = f"{code}.png"
            file_path = output_dir / file_name
            
            async with session.get(image_url, headers=headers) as img_response:
                if img_response.status == 200:
                    with open(file_path, 'wb') as f:
                        f.write(await img_response.read())
                    print(f"Изображение для {name} ({code}) сохранено: {file_path}")
                    return name, str(file_path)
                else:
                    print(f"Ошибка загрузки изображения для {name} ({code}): статус {img_response.status}")
                    return name, "Ошибка загрузки"
                    
    except Exception as e:
        print(f"Ошибка при обработке {name} ({code}): {e}")
        return name, "Ошибка загрузки"

async def main():
    async with aiohttp.ClientSession() as session:
        # Создаем задачи для каждого цвета
        tasks = [fetch_page(session, code, name) for code, name in tikkurila_colors.items()]
        # Ограничиваем количество одновременных запросов
        semaphore = asyncio.Semaphore(10)  # Максимум 10 одновременных запросов
        async def sem_task(task):
            async with semaphore:
                return await task
        # Выполняем задачи
        results = await asyncio.gather(*[sem_task(task) for task in tasks], return_exceptions=True)
        
        # Заполняем финальный словарь
        for name, path in results:
            if not isinstance(path, Exception):
                new_color_dict[name] = path

# Запускаем асинхронный цикл
asyncio.run(main())

# Выводим финальный словарь
print("\nФинальный словарь с путями к изображениям:")
for name, path in new_color_dict.items():
    print(f"{name}: {path}")